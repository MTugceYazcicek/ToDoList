<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="MT">
    <meta name="keywords" content="Basit YapÄ±lacak, YapÄ±lacak UygulamasÄ±, HTML, CSS, JavaScript">
    <meta name="description" content="Basit YapÄ±lacak UygulamasÄ±">
    <title>YapÄ±lacaklar</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="/Public/style.css">

</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm fixed-top">
        <div class="container">
            <a class="navbar-brand fw-bold text-black" href="index.html">Anasayfa</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="MenÃ¼yÃ¼ AÃ§/Kapat">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link text-black" href="#blog-posts">YapÄ±lacaklar Listesi</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-black" href="#gelecekblog">YapÄ±lacaklarÄ± Ekle</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <main class="container mt-5 text-center " id="main1">
        <h1>YapÄ±lacaklar</h1>
        <p>Bu basit yapÄ±lacak uygulamasÄ±, HTML, CSS ve JavaScript kullanÄ±larak oluÅŸturulmuÅŸtur.YapÄ±lacak notlarÄ±,
            kullanÄ±cÄ±larÄ±n gÃ¶revlerini, hatÄ±rlatmalarÄ±nÄ± ve kÃ¼Ã§Ã¼k notlarÄ±nÄ± tutmalarÄ±na olanak tanÄ±r.</p>
        Uygulama, Bootstrap kÃ¼tÃ¼phanesi ile tasarlanmÄ±ÅŸtÄ±r ve duyarlÄ± bir tasarÄ±ma sahiptir.</p>

    </main>


    <main class="container mt-5">
        <h2>YapÄ±lacak NotlarÄ±</h2>
        <div class="row" id="blog-posts"></div>
    </main>

    <!-- Dinamik modal'lar iÃ§in alan -->
    <div id="modals-container"></div>

    <gelecekbloglar id="gelecekblog">
        <div class="container">
            <div class="row">
                <div class="col-md-6 offset-md-3">
                    <div class="container mt-5">
                        <h2 class="mb-4 text-center">Yeni YapÄ±lacak Ekle</h2>
                        <form id="blogForm" class="p-4 rounded shadow bg-light">
                            <div class="mb-3">
                                <label class="form-label">KullanÄ±cÄ±</label>
                                <input type="text" class="form-control" value="KullanÄ±cÄ±nÄ±n Ä°smi" readonly>
                            </div>
                            <div class="mb-3">
                                <label for="Baslik" class="form-label">BaÅŸlÄ±k</label>
                                <input type="text" class="form-control" id="Baslik" name="Baslik" required>
                            </div>
                            <div class="mb-3">
                                <label for="BlogIcerigi" class="form-label">Ä°Ã§erik</label>
                                <textarea class="form-control" id="BlogIcerigi" name="BlogIcerigi" rows="5"
                                    required></textarea>
                            </div>
                            <div class="mb-3">
                                <label for="Goruntu" class="form-label">GÃ¶rsel URL</label>
                                <input type="text" class="form-control" id="Goruntu" name="Goruntu">
                            </div>
                            <button type="submit" class="btn btn-primary w-100">YapÄ±lacak Ekle</button>
                            <button type="reset" class="btn btn-secondary w-100 mt-2">Formu SÄ±fÄ±rla</button>
                        </form>
                    </div>


                </div>

            </div>
        </div>
    </gelecekbloglar>


    <footer class="bg-light text-center text-lg-start mt-5" id="footer">
        <div class="container py-4">
            <div class="row text-start">
                <div class="col-md-12 mb-3">
                    <h5>Bilgilendirme</h5>
                    <p>Basit YapÄ±lacak, kullanÄ±cÄ±larÄ±n gÃ¶revlerini paylaÅŸabileceÄŸi sade ve kullanÄ±mÄ± kolay bir not
                        defteri platformudur.</p>
                </div>
            </div>

            <div class="text-center p-3 border-top">
                Â© 2024 Basit YapÄ±lacak UygulamasÄ±
            </div>
    </footer>

    <script src="/Public/js/js.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", async () => {
            try {
                const response = await fetch("/blogyazarlari");
                const bloglar = await response.json();

                const blogContainer = document.getElementById("blog-posts");
                const modalContainer = document.getElementById("modals-container");

                bloglar.forEach((blog, index) => {
                    const modalId = `modal${index}`;

                    // âœ… Kart oluÅŸtur
                    const card = document.createElement("div");
                    card.className = "col-md-4 mb-4";
                    card.innerHTML = `
                <div class="card h-100">
                    <img src="${blog.Goruntu || 'https://via.placeholder.com/300x150'}" class="card-img-top" alt="GÃ¶rsel">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">${blog.Baslik || 'BaÅŸlÄ±k Yok'}</h5>
                        <p class="card-text">${blog.BlogIcerigi.substring(0, 100)}...</p>
                        <div class="mt-auto">
                            <a href="#${modalId}" data-bs-toggle="modal" class="btn btn-primary mb-2">DevamÄ±nÄ± Oku</a>
                            <button onclick="blogSil(${blog.BlogID})" class="btn btn-danger w-50">Sil</button>
                        </div>
                    </div>
                </div>
            `;
                    blogContainer.appendChild(card);

                    // âœ… Modal oluÅŸtur
                    const modal = document.createElement("div");
                    modal.className = "modal fade";
                    modal.id = modalId;
                    modal.setAttribute("data-bs-backdrop", "static");
                    modal.setAttribute("tabindex", "-1");
                    modal.setAttribute("aria-hidden", "true");
                    modal.innerHTML = `
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h1 class="modal-title fs-5">${blog.Baslik}</h1>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Kapat"></button>
                        </div>
                        <div class="modal-body">
                            <p><strong>Ä°Ã§erik:</strong> ${blog.BlogIcerigi}</p>
                            <p><strong>Yazar:</strong> ${blog.YazarAdi || 'Bilinmiyor'}</p>
                            <p><strong>OluÅŸturulma:</strong> ${new Date(blog.OlusturulmaTarihi).toLocaleString()}</p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Kapat</button>
                        </div>
                    </div>
                </div>
            `;
                    modalContainer.appendChild(modal);
                });

            } catch (err) {
                console.error("Veri alÄ±nÄ±rken hata:", err);
            }
        });

        // âœ… YapÄ±lacak ekleme
        document.getElementById('blogForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            const formData = new FormData(this);
            const data = Object.fromEntries(formData);

            // ðŸ”¹ KullanÄ±cÄ± ID'yi burada otomatik ekliyoruz
            data.KullaniciID = 1;

            const response = await fetch('/blog-ekle', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            const result = await response.text();
            alert(result);
            window.location.reload(); // SayfayÄ± yenile
        });

        // âœ… YapÄ±lacak silme fonksiyonu
        async function blogSil(blogID) {
            if (!confirm("Bu yapÄ±lacaÄŸÄ± silmek istediÄŸinizden emin misiniz?")) return;

            const response = await fetch(`/blog-sil/${blogID}`, {
                method: 'DELETE'
            });

            const sonuc = await response.text();
            alert(sonuc);
            window.location.reload(); // Silme sonrasÄ± sayfayÄ± yenile
        }
    </script>



</body>

</html>